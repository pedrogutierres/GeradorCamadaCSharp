using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace GeradorCamadaCSharp.Library
{
    public class ArquivoFuncoes
    {
        public static string RetornaTextoArquivoFuncoes(string pacote)
        {
            StringBuilder funcoes = new StringBuilder();
            funcoes.AppendLine("using MySql.Data.MySqlClient;                                                                                                                                                                                                               ");
            funcoes.AppendLine("using System;                                                                                                                                                                                                                               ");
            funcoes.AppendLine("using System.Collections;                                                                                                                                                                                                                   ");
            funcoes.AppendLine("using System.Collections.Generic;                                                                                                                                                                                                           ");
            funcoes.AppendLine("using System.Data;                                                                                                                                                                                                                          ");
            funcoes.AppendLine("using System.Data.Common;                                                                                                                                                                                                                   ");
            funcoes.AppendLine("using System.IO;                                                                                                                                                                                                                            ");
            funcoes.AppendLine("using System.Linq;                                                                                                                                                                                                                          ");
            funcoes.AppendLine("using System.Reflection;                                                                                                                                                                                                                    ");
            funcoes.AppendLine("using System.Xml.Linq;                                                                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("namespace " + pacote + ".Util                                                                                                                                                                                                                          ");
            funcoes.AppendLine("{                                                                                                                                                                                                                                           ");
            funcoes.AppendLine("    public class Funcoes                                                                                                                                                                                                                    ");
            funcoes.AppendLine("    {                                                                                                                                                                                                                                       ");
            funcoes.AppendLine("        private static Funcoes f;                                                                                                                                                                                                           ");
            funcoes.AppendLine("        private static string webConfig = \"Web.config\";                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        private static string AssemblyDirectory                                                                                                                                                                                             ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            get                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                string codeBase = Assembly.GetExecutingAssembly().CodeBase;                                                                                                                                                                 ");
            funcoes.AppendLine("                UriBuilder uri = new UriBuilder(codeBase);                                                                                                                                                                                  ");
            funcoes.AppendLine("                string path = Uri.UnescapeDataString(uri.Path);                                                                                                                                                                             ");
            funcoes.AppendLine("                return Path.GetDirectoryName(path);                                                                                                                                                                                         ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        private Funcoes()                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            CarregarArquivoWebConfig();                                                                                                                                                                                                     ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        private void CarregarArquivoWebConfig()                                                                                                                                                                                             ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                if (!File.Exists(AssemblyDirectory.Replace(\"\\bin\", \"\") + @\"\\\" + webConfig))                                                                                                                                          ");
            funcoes.AppendLine("                    return;                                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                XElement xml = XElement.Load(AssemblyDirectory.Replace(\"bin\", \"\") + @\"\\\" + webConfig);                                                                                                                                ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                IEnumerable<XElement> elementos = xml.Elements().Where(p => p.Name.LocalName == \"appSettings\").Descendants().Where(p => p.Name.LocalName == \"add\");                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                IdLojaCadastro = RecuperarValueInt(elementos, \"LojaCadastro\");                                                                                                                                                            ");
            funcoes.AppendLine("                IpBancoCadastro = RecuperarValueString(elementos, \"IpBancoCadastro\");                                                                                                                                                     ");
            funcoes.AppendLine("                UsuarioBancoCadastro = RecuperarValueString(elementos, \"UsuarioBancoCadastro\");                                                                                                                                           ");
            funcoes.AppendLine("                SenhaBancoCadastro = RecuperarValueString(elementos, \"SenhaBancoCadastro\");                                                                                                                                               ");
            funcoes.AppendLine("                NomeBancoCadastro = RecuperarValueString(elementos, \"NomeBancoCadastro\");                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                IdLojaPedido = RecuperarValueInt(elementos, \"LojaPedido\");                                                                                                                                                                ");
            funcoes.AppendLine("                IpBancoPedido = RecuperarValueString(elementos, \"IpBancoPedido\");                                                                                                                                                         ");
            funcoes.AppendLine("                UsuarioBancoPedido = RecuperarValueString(elementos, \"UsuarioBancoPedido\");                                                                                                                                               ");
            funcoes.AppendLine("                SenhaBancoPedido = RecuperarValueString(elementos, \"SenhaBancoPedido\");                                                                                                                                                   ");
            funcoes.AppendLine("                NomeBancoPedido = RecuperarValueString(elementos, \"NomeBancoPedido\");                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                AplicaConexaoCadastro();                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            { }                                                                                                                                                                                                                             ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        private Funcoes(int lojaCadastro, string ipCadastro, string senhaCadastro, string nomeCadastro, string usuarioCadastro,                                                                                                             ");
            funcoes.AppendLine("                        int lojaPedido, string ipPedido, string senhaPedido, string nomePedido, string usuarioPedido)                                                                                                                       ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            IdLojaCadastro = lojaCadastro;                                                                                                                                                                                                  ");
            funcoes.AppendLine("            IpBancoCadastro = ipCadastro;                                                                                                                                                                                                   ");
            funcoes.AppendLine("            SenhaBancoCadastro = senhaCadastro;                                                                                                                                                                                             ");
            funcoes.AppendLine("            NomeBancoCadastro = nomeCadastro;                                                                                                                                                                                               ");
            funcoes.AppendLine("            UsuarioBancoCadastro = usuarioCadastro;                                                                                                                                                                                         ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            IdLojaPedido = lojaPedido;                                                                                                                                                                                                      ");
            funcoes.AppendLine("            IpBancoPedido = ipPedido;                                                                                                                                                                                                       ");
            funcoes.AppendLine("            SenhaBancoPedido = senhaPedido;                                                                                                                                                                                                 ");
            funcoes.AppendLine("            NomeBancoPedido = nomePedido;                                                                                                                                                                                                   ");
            funcoes.AppendLine("            UsuarioBancoPedido = usuarioPedido;                                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            AplicaConexaoCadastro();                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public static Funcoes newInstance()                                                                                                                                                                                                 ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            if (f == null)                                                                                                                                                                                                                  ");
            funcoes.AppendLine("                f = new Funcoes();                                                                                                                                                                                                          ");
            funcoes.AppendLine("            return f;                                                                                                                                                                                                                       ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public static int IdLojaCadastro { get; set; }                                                                                                                                                                                      ");
            funcoes.AppendLine("        public static string IpBancoCadastro { get; set; }                                                                                                                                                                                  ");
            funcoes.AppendLine("        public static string SenhaBancoCadastro { get; set; }                                                                                                                                                                               ");
            funcoes.AppendLine("        public static string NomeBancoCadastro { get; set; }                                                                                                                                                                                ");
            funcoes.AppendLine("        public static string UsuarioBancoCadastro { get; set; }                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public static int IdLojaPedido { get; set; }                                                                                                                                                                                        ");
            funcoes.AppendLine("        public static string IpBancoPedido { get; set; }                                                                                                                                                                                    ");
            funcoes.AppendLine("        public static string SenhaBancoPedido { get; set; }                                                                                                                                                                                 ");
            funcoes.AppendLine("        public static string NomeBancoPedido { get; set; }                                                                                                                                                                                  ");
            funcoes.AppendLine("        public static string UsuarioBancoPedido { get; set; }                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public string StringConexao { get; set; }                                                                                                                                                                                           ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        private bool ConexaoCadastro = false;                                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public string StringConexaoCadastro                                                                                                                                                                                                 ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            get { return @\"server=\" + IpBancoCadastro + \";user id=\" + UsuarioBancoCadastro + \";Password=\" + SenhaBancoCadastro + \";database=\" + NomeBancoCadastro + \"; pooling=false; Allow User Variables=True;\"; }              ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public string StringConexaoPedido                                                                                                                                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            get { return @\"server=\" + IpBancoPedido + \";user id=\" + UsuarioBancoPedido + \";Password=\" + SenhaBancoPedido + \";database=\" + NomeBancoPedido + \"; pooling=false; Allow User Variables=True;\"; }                      ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public void AplicaConexaoCadastro()                                                                                                                                                                                                 ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            if (!ConexaoCadastro)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                StringConexao = StringConexaoCadastro;                                                                                                                                                                                      ");
            funcoes.AppendLine("                ConexaoCadastro = true;                                                                                                                                                                                                     ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public void AplicaConexaoPedido()                                                                                                                                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            if (ConexaoCadastro)                                                                                                                                                                                                            ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                StringConexao = StringConexaoPedido;                                                                                                                                                                                        ");
            funcoes.AppendLine("                ConexaoCadastro = false;                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        private string RecuperarValueString(IEnumerable<XElement> elementos, string key)                                                                                                                                                    ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            string value = string.Empty;                                                                                                                                                                                                    ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                value = elementos.Where(p => p.Attribute(XName.Get(\"key\")).Value == key).Select(p => p.Attribute(XName.Get(\"value\")).Value).FirstOrDefault();                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            { }                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            return value;                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        private int RecuperarValueInt(IEnumerable<XElement> elementos, string key)                                                                                                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            int value = 0;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                value = ConvertToInt32(elementos.Where(p => p.Attribute(XName.Get(\"key\")).Value == key).Select(p => p.Attribute(XName.Get(\"value\")).Value).FirstOrDefault(), 0);                                                        ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            { }                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            return value;                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        private bool RecuperarValueBool(IEnumerable<XElement> elementos, string key)                                                                                                                                                        ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            bool value = false;                                                                                                                                                                                                             ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                value = ConvertToBoolean(elementos.Where(p => p.Attribute(XName.Get(\"key\")).Value == key).Select(p => p.Attribute(XName.Get(\"value\")).Value).FirstOrDefault());                                                         ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            { }                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            return value;                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public string AjustaValor(string _valor)                                                                                                                                                                                            ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            return _valor.Replace(\".\", \"#\").Replace(\",\", \".\").Replace(\"#\", \"\");                                                                                                                                                 ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public string RecuperaParametro(string _parametro, int _loja, string _padrao = \"\")                                                                                                                                                ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                string comando = \"select valor from config where loja = ?loja and parametro = ?parametro order by loja, parametro\";                                                                                                       ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                MySqlParameter[] parms = new MySqlParameter[2];                                                                                                                                                                             ");
            funcoes.AppendLine("                parms[0] = CreateParameter(\"?parametro\", MySqlDbType.VarChar, _parametro);                                                                                                                                                ");
            funcoes.AppendLine("                parms[1] = CreateParameter(\"?loja\", MySqlDbType.Int16, _loja);                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                using (MySqlDataReader rdr = ExecuteReader(CommandType.Text, comando, parms))                                                                                                                                               ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    if (rdr.Read())                                                                                                                                                                                                         ");
            funcoes.AppendLine("                        return rdr.IsDBNull(0) ? _padrao : rdr.GetString(0);                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                return _padrao;                                                                                                                                                                                                             ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return _padrao;                                                                                                                                                                                                             ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public char Chr(int codigo)                                                                                                                                                                                                         ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            return (char)codigo;                                                                                                                                                                                                            ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        //Criando Parametros                                                                                                                                                                                                                ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public MySqlParameter CreateParameter(string _nomeParam, MySqlDbType _tipoParam, object _valorParam)                                                                                                                                ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            return CreateParameter(_nomeParam, ParameterDirection.Input, _tipoParam, _valorParam, null);                                                                                                                                    ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public MySqlParameter CreateParameter(string _nomeParam, ParameterDirection _paramDirection, MySqlDbType _tipoParam, object _valorParam)                                                                                            ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            return CreateParameter(_nomeParam, _paramDirection, _tipoParam, _valorParam, null);                                                                                                                                             ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public MySqlParameter CreateParameter(string _nomeParam, MySqlDbType _tipoParam, object _valorParam, object _valorNulo)                                                                                                             ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            return CreateParameter(_nomeParam, ParameterDirection.Input, _tipoParam, _valorParam, _valorNulo);                                                                                                                              ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public MySqlParameter CreateParameter(string _nomeParam, ParameterDirection _paramDirection, MySqlDbType _tipoParam, object _valorParam, object _valorNulo)                                                                         ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            MySqlParameter param = new MySqlParameter();                                                                                                                                                                                    ");
            funcoes.AppendLine("            param.ParameterName = _nomeParam;                                                                                                                                                                                               ");
            funcoes.AppendLine("            param.MySqlDbType = _tipoParam;                                                                                                                                                                                                 ");
            funcoes.AppendLine("            param.Direction = _paramDirection;                                                                                                                                                                                              ");
            funcoes.AppendLine("            if (_valorParam == null || _valorParam == DBNull.Value)                                                                                                                                                                         ");
            funcoes.AppendLine("                param.Value = DBNull.Value;                                                                                                                                                                                                 ");
            funcoes.AppendLine("            else if (_valorNulo != null && _valorNulo.ToString().Equals(_valorParam.ToString()))                                                                                                                                            ");
            funcoes.AppendLine("                param.Value = DBNull.Value;                                                                                                                                                                                                 ");
            funcoes.AppendLine("            else                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                switch (_tipoParam)                                                                                                                                                                                                         ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    case MySqlDbType.VarChar:                                                                                                                                                                                               ");
            funcoes.AppendLine("                    case MySqlDbType.String:                                                                                                                                                                                                ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                            if (String.IsNullOrEmpty(_valorParam.ToString()))                                                                                                                                                               ");
            funcoes.AppendLine("                                param.Value = DBNull.Value;                                                                                                                                                                                 ");
            funcoes.AppendLine("                            else                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                param.Value = _valorParam.ToString();                                                                                                                                                                       ");
            funcoes.AppendLine("                            break;                                                                                                                                                                                                          ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                    case MySqlDbType.DateTime:                                                                                                                                                                                              ");
            funcoes.AppendLine("                    case MySqlDbType.Date:                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                            DateTime dateTime = Convert.ToDateTime(_valorParam);                                                                                                                                                            ");
            funcoes.AppendLine("                            if (dateTime.Equals(DateTime.MinValue))                                                                                                                                                                         ");
            funcoes.AppendLine("                                param.Value = DBNull.Value;                                                                                                                                                                                 ");
            funcoes.AppendLine("                            else                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                param.Value = dateTime;                                                                                                                                                                                     ");
            funcoes.AppendLine("                            break;                                                                                                                                                                                                          ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                    default:                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                            param.Value = _valorParam;                                                                                                                                                                                      ");
            funcoes.AppendLine("                            break;                                                                                                                                                                                                          ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            return param;                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        //Trabalhando com String de Conexão Constante                                                                                                                                                                                       ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                                                  ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                using (MySqlConnection cnx = new MySqlConnection(StringConexao))                                                                                                                                                            ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                           ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                             ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                              ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                               ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                          ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                            ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                           ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                              ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        int i = cmd.ExecuteNonQuery();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        _lastInsertId = cmd.LastInsertedId;                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        return i > 0;                                                                                                                                                                                                       ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            return ExecuteNonQuery(_cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                                                ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                                               ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                using (MySqlConnection cnx = new MySqlConnection(StringConexao))                                                                                                                                                            ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                           ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                             ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                              ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                               ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                          ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                            ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                           ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                              ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        int i = cmd.ExecuteNonQuery();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        _lastInsertId = cmd.LastInsertedId;                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        return i;                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                                       ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            return ExecuteNonQueryRows(_cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                                            ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public object ExecuteScalar(CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                using (MySqlConnection cnx = new MySqlConnection(StringConexao))                                                                                                                                                            ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                           ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                             ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                              ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                               ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                          ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                            ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                           ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                              ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        object i = cmd.ExecuteScalar();                                                                                                                                                                                     ");
            funcoes.AppendLine("                        return i;                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public MySqlDataReader ExecuteReader(CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                                 ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                MySqlConnection cnx = new MySqlConnection(StringConexao);                                                                                                                                                                   ");
            funcoes.AppendLine("                using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                               ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.Connection = cnx;                                                                                                                                                                                                   ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                             ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                              ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    if (cnx.State != ConnectionState.Open)                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cnx.Open();                                                                                                                                                                                                         ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    MySqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);                                                                                                                                               ");
            funcoes.AppendLine("                    return rdr;                                                                                                                                                                                                             ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public DataTable FillDataTable(CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                                       ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                DataTable dt = new DataTable();                                                                                                                                                                                             ");
            funcoes.AppendLine("                MySqlConnection cnx = new MySqlConnection(StringConexao);                                                                                                                                                                   ");
            funcoes.AppendLine("                using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                               ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.Connection = cnx;                                                                                                                                                                                                   ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                             ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                              ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                 ");
            funcoes.AppendLine("                    using (MySqlDataAdapter da = new MySqlDataAdapter(cmd))                                                                                                                                                                 ");
            funcoes.AppendLine("                        da.Fill(dt);                                                                                                                                                                                                        ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                return dt;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        //Trabalhando com String de Conexao Variável                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(string _stringConexao, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                           ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                using (MySqlConnection cnx = new MySqlConnection(_stringConexao))                                                                                                                                                           ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                           ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                             ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                              ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                               ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                          ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                            ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                           ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                              ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        int i = cmd.ExecuteNonQuery();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        _lastInsertId = cmd.LastInsertedId;                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        return i > 0;                                                                                                                                                                                                       ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(string _stringConexao, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            return ExecuteNonQuery(_stringConexao, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                                ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(string _stringConexao, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                        ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                using (MySqlConnection cnx = new MySqlConnection(_stringConexao))                                                                                                                                                           ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                           ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                             ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                              ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                               ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                          ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                            ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                           ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                              ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        int i = cmd.ExecuteNonQuery();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        _lastInsertId = cmd.LastInsertedId;                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        return i;                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(string _stringConexao, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            return ExecuteNonQueryRows(_stringConexao, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                            ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public object ExecuteScalar(string _stringConexao, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                using (MySqlConnection cnx = new MySqlConnection(_stringConexao))                                                                                                                                                           ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                           ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                             ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                              ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                               ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                          ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                            ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                           ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                              ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        object i = cmd.ExecuteScalar();                                                                                                                                                                                     ");
            funcoes.AppendLine("                        return i;                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                       ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public MySqlDataReader ExecuteReader(string _stringConexao, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                MySqlConnection cnx = new MySqlConnection(_stringConexao);                                                                                                                                                                  ");
            funcoes.AppendLine("                using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                               ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.Connection = cnx;                                                                                                                                                                                                   ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                             ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                              ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    if (cnx.State != ConnectionState.Open)                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cnx.Open();                                                                                                                                                                                                         ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    MySqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);                                                                                                                                               ");
            funcoes.AppendLine("                    return rdr;                                                                                                                                                                                                             ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public DataTable FillDataTable(string _stringConexao, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                DataTable dt = new DataTable();                                                                                                                                                                                             ");
            funcoes.AppendLine("                MySqlConnection cnx = new MySqlConnection(_stringConexao);                                                                                                                                                                  ");
            funcoes.AppendLine("                using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                               ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.Connection = cnx;                                                                                                                                                                                                   ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                             ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                              ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                 ");
            funcoes.AppendLine("                    using (MySqlDataAdapter da = new MySqlDataAdapter(cmd))                                                                                                                                                                 ");
            funcoes.AppendLine("                        da.Fill(dt);                                                                                                                                                                                                        ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                return dt;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        //Trabalhando com Objeto de Conexão                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public MySqlConnection OpenConnection(string _connectionString)                                                                                                                                                                     ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            if (String.IsNullOrEmpty(_connectionString))                                                                                                                                                                                    ");
            funcoes.AppendLine("                throw new ArgumentNullException();                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                MySqlConnection cnx = new MySqlConnection(_connectionString);                                                                                                                                                               ");
            funcoes.AppendLine("                if (cnx.State != ConnectionState.Open)                                                                                                                                                                                      ");
            funcoes.AppendLine("                    cnx.Open();                                                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                return cnx;                                                                                                                                                                                                                 ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException dbError)                                                                                                                                                                                                  ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(dbError.Message, dbError);                                                                                                                                                                              ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception error)                                                                                                                                                                                                         ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(error.Message, error);                                                                                                                                                                                  ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public MySqlConnection OpenConnection()                                                                                                                                                                                             ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            return OpenConnection(StringConexao);                                                                                                                                                                                           ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public void CloseConnection(MySqlConnection _connection)                                                                                                                                                                            ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                if (_connection == null)                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    return;                                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                _connection.Close();                                                                                                                                                                                                        ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException dbError)                                                                                                                                                                                                  ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(dbError.Message, dbError);                                                                                                                                                                              ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception error)                                                                                                                                                                                                         ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(error.Message, error);                                                                                                                                                                                  ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(MySqlConnection _connection, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                     ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                               ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.Connection = _connection;                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                             ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                              ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    if (_connection.State != ConnectionState.Open)                                                                                                                                                                          ");
            funcoes.AppendLine("                        _connection.Open();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    int i = cmd.ExecuteNonQuery();                                                                                                                                                                                          ");
            funcoes.AppendLine("                    _lastInsertId = cmd.LastInsertedId;                                                                                                                                                                                     ");
            funcoes.AppendLine("                    return i > 0;                                                                                                                                                                                                           ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(MySqlConnection _connection, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                             ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            return ExecuteNonQuery(_connection, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                                   ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(MySqlConnection _connection, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                  ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                               ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.Connection = _connection;                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                             ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                              ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    if (_connection.State != ConnectionState.Open)                                                                                                                                                                          ");
            funcoes.AppendLine("                        _connection.Open();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    int i = cmd.ExecuteNonQuery();                                                                                                                                                                                          ");
            funcoes.AppendLine("                    _lastInsertId = cmd.LastInsertedId;                                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    return i;                                                                                                                                                                                                               ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(MySqlConnection _connection, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            return ExecuteNonQueryRows(_connection, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public object ExecuteScalar(MySqlConnection _connection, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                             ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                               ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.Connection = _connection;                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                             ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                              ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    if (_connection.State != ConnectionState.Open)                                                                                                                                                                          ");
            funcoes.AppendLine("                        _connection.Open();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    object i = cmd.ExecuteScalar();                                                                                                                                                                                         ");
            funcoes.AppendLine("                    return i;                                                                                                                                                                                                               ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public MySqlDataReader ExecuteReader(MySqlConnection _connection, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                    ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                               ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.Connection = _connection;                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                             ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                              ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    if (_connection.State != ConnectionState.Open)                                                                                                                                                                          ");
            funcoes.AppendLine("                        _connection.Open();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    MySqlDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);                                                                                                                                               ");
            funcoes.AppendLine("                    return rdr;                                                                                                                                                                                                             ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public DataTable FillDataTable(MySqlConnection _connection, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                DataTable dt = new DataTable();                                                                                                                                                                                             ");
            funcoes.AppendLine("                using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                               ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.Connection = _connection;                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                             ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                              ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                 ");
            funcoes.AppendLine("                    using (MySqlDataAdapter da = new MySqlDataAdapter(cmd))                                                                                                                                                                 ");
            funcoes.AppendLine("                        da.Fill(dt);                                                                                                                                                                                                        ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                return dt;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        //Trabalhando com Transação                                                                                                                                                                                                         ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        MySqlTransaction BeginTransaction(string _connectionString, IsolationLevel _isolationLevel)                                                                                                                                         ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            MySqlTransaction trans = null;                                                                                                                                                                                                  ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                MySqlConnection conn = new MySqlConnection(_connectionString);                                                                                                                                                              ");
            funcoes.AppendLine("                if (conn.State != ConnectionState.Open)                                                                                                                                                                                     ");
            funcoes.AppendLine("                    conn.Open();                                                                                                                                                                                                            ");
            funcoes.AppendLine("                trans = conn.BeginTransaction(_isolationLevel);                                                                                                                                                                             ");
            funcoes.AppendLine("                return trans;                                                                                                                                                                                                               ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException dbError)                                                                                                                                                                                                  ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(dbError.Message, dbError);                                                                                                                                                                              ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception error)                                                                                                                                                                                                         ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(error.Message, error);                                                                                                                                                                                  ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public MySqlTransaction BeginTransaction(string _connectionString)                                                                                                                                                                  ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            if (String.IsNullOrEmpty(_connectionString))                                                                                                                                                                                    ");
            funcoes.AppendLine("                throw new ArgumentNullException();                                                                                                                                                                                          ");
            funcoes.AppendLine("            return BeginTransaction(_connectionString, IsolationLevel.ReadCommitted);                                                                                                                                                       ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public MySqlTransaction BeginTransaction()                                                                                                                                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            if (String.IsNullOrEmpty(StringConexao))                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new ArgumentNullException();                                                                                                                                                                                          ");
            funcoes.AppendLine("            return BeginTransaction(StringConexao, IsolationLevel.ReadCommitted);                                                                                                                                                           ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public void CommitTransaction(MySqlTransaction _transaction)                                                                                                                                                                        ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                       ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                try                                                                                                                                                                                                                         ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    MySqlConnection conn = _transaction.Connection;                                                                                                                                                                         ");
            funcoes.AppendLine("                    _transaction.Commit();                                                                                                                                                                                                  ");
            funcoes.AppendLine("                    if (conn != null)                                                                                                                                                                                                       ");
            funcoes.AppendLine("                        conn.Dispose();                                                                                                                                                                                                     ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                catch (MySqlException dbError)                                                                                                                                                                                              ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    throw new Exception(dbError.Message, dbError);                                                                                                                                                                          ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                catch (Exception error)                                                                                                                                                                                                     ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    throw new Exception(error.Message, error);                                                                                                                                                                              ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            else                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                throw new ArgumentException(\"Object transaction cannot be null\");                                                                                                                                                         ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public void RollbackTransaction(MySqlTransaction _transaction)                                                                                                                                                                      ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                       ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                try                                                                                                                                                                                                                         ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    MySqlConnection conn = _transaction.Connection;                                                                                                                                                                         ");
            funcoes.AppendLine("                    _transaction.Rollback();                                                                                                                                                                                                ");
            funcoes.AppendLine("                    if (conn != null)                                                                                                                                                                                                       ");
            funcoes.AppendLine("                        conn.Dispose();                                                                                                                                                                                                     ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                catch (MySqlException dbError)                                                                                                                                                                                              ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    throw new Exception(dbError.Message, dbError);                                                                                                                                                                          ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                catch (Exception error)                                                                                                                                                                                                     ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    throw new Exception(error.Message, error);                                                                                                                                                                              ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            else                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                throw new ArgumentException(\"Object transaction cannot be null\");                                                                                                                                                         ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(MySqlTransaction _transaction, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            MySqlConnection cnx = _transaction.Connection;                                                                                                                                                                                  ");
            funcoes.AppendLine("            MySqlCommand cmd = new MySqlCommand();                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            cmd.Parameters.Clear();                                                                                                                                                                                                         ");
            funcoes.AppendLine("            if (_parmsSQL != null)                                                                                                                                                                                                          ");
            funcoes.AppendLine("                cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                         ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            cmd.Connection = cnx;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            cmd.CommandType = _cmdType;                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.CommandText = _cmdSQL;                                                                                                                                                                                                      ");
            funcoes.AppendLine("            if (_commandTimeout > 0)                                                                                                                                                                                                        ");
            funcoes.AppendLine("                cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                                       ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (cnx.State != ConnectionState.Open)                                                                                                                                                                                          ");
            funcoes.AppendLine("                cnx.Open();                                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                       ");
            funcoes.AppendLine("                cmd.Transaction = _transaction;                                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            int i = cmd.ExecuteNonQuery();                                                                                                                                                                                                  ");
            funcoes.AppendLine("            _lastInsertId = cmd.LastInsertedId;                                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            return i > 0;                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(MySqlTransaction _transaction, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                           ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            return ExecuteNonQuery(_transaction, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                                  ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(MySqlTransaction _transaction, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            MySqlConnection cnx = _transaction.Connection;                                                                                                                                                                                  ");
            funcoes.AppendLine("            MySqlCommand cmd = new MySqlCommand();                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            cmd.Parameters.Clear();                                                                                                                                                                                                         ");
            funcoes.AppendLine("            if (_parmsSQL != null)                                                                                                                                                                                                          ");
            funcoes.AppendLine("                cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                         ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            cmd.Connection = cnx;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            cmd.CommandType = _cmdType;                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.CommandText = _cmdSQL;                                                                                                                                                                                                      ");
            funcoes.AppendLine("            if (_commandTimeout > 0)                                                                                                                                                                                                        ");
            funcoes.AppendLine("                cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                                       ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (cnx.State != ConnectionState.Open)                                                                                                                                                                                          ");
            funcoes.AppendLine("                cnx.Open();                                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                       ");
            funcoes.AppendLine("                cmd.Transaction = _transaction;                                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            int i = cmd.ExecuteNonQuery();                                                                                                                                                                                                  ");
            funcoes.AppendLine("            _lastInsertId = cmd.LastInsertedId;                                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            return i;                                                                                                                                                                                                                       ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(MySqlTransaction _transaction, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                        ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            return ExecuteNonQueryRows(_transaction, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                              ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public object ExecuteScalar(MySqlTransaction _transaction, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                           ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            MySqlConnection cnx = _transaction.Connection;                                                                                                                                                                                  ");
            funcoes.AppendLine("            MySqlCommand cmd = new MySqlCommand();                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            cmd.Parameters.Clear();                                                                                                                                                                                                         ");
            funcoes.AppendLine("            if (_parmsSQL != null)                                                                                                                                                                                                          ");
            funcoes.AppendLine("                cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                         ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            cmd.Connection = cnx;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            cmd.CommandType = _cmdType;                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.CommandText = _cmdSQL;                                                                                                                                                                                                      ");
            funcoes.AppendLine("            if (_commandTimeout > 0)                                                                                                                                                                                                        ");
            funcoes.AppendLine("                cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                                       ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (cnx.State != ConnectionState.Open)                                                                                                                                                                                          ");
            funcoes.AppendLine("                cnx.Open();                                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                       ");
            funcoes.AppendLine("                cmd.Transaction = _transaction;                                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            object i = cmd.ExecuteScalar();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            return i;                                                                                                                                                                                                                       ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public MySqlDataReader ExecuteReader(MySqlTransaction _transaction, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                  ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            MySqlConnection cnx = _transaction.Connection;                                                                                                                                                                                  ");
            funcoes.AppendLine("            MySqlCommand cmd = new MySqlCommand();                                                                                                                                                                                          ");
            funcoes.AppendLine("            cmd.Connection = cnx;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            cmd.CommandType = _cmdType;                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.CommandText = _cmdSQL;                                                                                                                                                                                                      ");
            funcoes.AppendLine("            if (_commandTimeout > 0)                                                                                                                                                                                                        ");
            funcoes.AppendLine("                cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                                       ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            cmd.Parameters.Clear();                                                                                                                                                                                                         ");
            funcoes.AppendLine("            if (_parmsSQL != null)                                                                                                                                                                                                          ");
            funcoes.AppendLine("                cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                         ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (cnx.State != ConnectionState.Open)                                                                                                                                                                                          ");
            funcoes.AppendLine("                cnx.Open();                                                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                       ");
            funcoes.AppendLine("                cmd.Transaction = _transaction;                                                                                                                                                                                             ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            MySqlDataReader rdr = cmd.ExecuteReader();                                                                                                                                                                                      ");
            funcoes.AppendLine("            return rdr;                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public DataTable FillDataTable(MySqlTransaction _transaction, CommandType _cmdType, string _cmdSQL, MySqlParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                        ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                DataTable dt = new DataTable();                                                                                                                                                                                             ");
            funcoes.AppendLine("                using (MySqlCommand cmd = new MySqlCommand())                                                                                                                                                                               ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    cmd.Connection = _transaction.Connection;                                                                                                                                                                               ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                             ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                              ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    if (_transaction != null)                                                                                                                                                                                               ");
            funcoes.AppendLine("                        cmd.Transaction = _transaction;                                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    using (MySqlDataAdapter da = new MySqlDataAdapter(cmd))                                                                                                                                                                 ");
            funcoes.AppendLine("                        da.Fill(dt);                                                                                                                                                                                                        ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                return dt;                                                                                                                                                                                                                  ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (MySqlException mErr)                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        ///////////////////////////////                                                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public string ShowSQLCommand(string _commandText, IDataParameter[] _cmdParameters, string[] _ignoreParameters = null)                                                                                                               ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            string parameterValue = string.Empty;                                                                                                                                                                                           ");
            funcoes.AppendLine("            for (int indexParameters = _cmdParameters.Length - 1; indexParameters >= 0; indexParameters--)                                                                                                                                  ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                parameterValue = string.Empty;                                                                                                                                                                                              ");
            funcoes.AppendLine("                string identifier = _cmdParameters[indexParameters].ParameterName.Contains(\"?\") ? string.Empty : \"?\";                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                if (_ignoreParameters != null && _ignoreParameters.ToList().Exists(p => (\"?\" + p.ToLower()).Equals(_cmdParameters[indexParameters].ParameterName.ToLower())))                                                             ");
            funcoes.AppendLine("                    continue;                                                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                if (_cmdParameters[indexParameters].DbType == DbType.DateTime)                                                                                                                                                              ");
            funcoes.AppendLine("                    parameterValue = string.IsNullOrEmpty(_cmdParameters[indexParameters].Value.ToString()) ? \"NULL\" : \"'\" + Convert.ToDateTime(_cmdParameters[indexParameters].Value).ToString(\"yyyy-MM-dd HH:mm:ss\") + \"'\";       ");
            funcoes.AppendLine("                else if (_cmdParameters[indexParameters].DbType == DbType.Date)                                                                                                                                                             ");
            funcoes.AppendLine("                    parameterValue = string.IsNullOrEmpty(_cmdParameters[indexParameters].Value.ToString()) ? \"NULL\" : \"'\" + Convert.ToDateTime(_cmdParameters[indexParameters].Value).ToString(\"yyyy-MM-dd\") + \"'\";                ");
            funcoes.AppendLine("                else if (_cmdParameters[indexParameters].DbType == DbType.Decimal || _cmdParameters[indexParameters].DbType == DbType.Double || _cmdParameters[indexParameters].DbType == DbType.Single)                                    ");
            funcoes.AppendLine("                    parameterValue = AjustaValor(_cmdParameters[indexParameters].Value.ToString());                                                                                                                                         ");
            funcoes.AppendLine("                else if (_cmdParameters[indexParameters].DbType == DbType.Int16 || _cmdParameters[indexParameters].DbType == DbType.Int32 || _cmdParameters[indexParameters].DbType == DbType.Int64)                                        ");
            funcoes.AppendLine("                    parameterValue = ConvertToInt64(_cmdParameters[indexParameters].Value).ToString();                                                                                                                                      ");
            funcoes.AppendLine("                else                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                    parameterValue = string.IsNullOrEmpty(_cmdParameters[indexParameters].Value.ToString()) ? \"NULL\" : \"'\" + _cmdParameters[indexParameters].Value.ToString() + \"'\";                                                  ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                _commandText = _commandText.Replace(identifier + _cmdParameters[indexParameters].ParameterName, parameterValue);                                                                                                            ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            return _commandText.Replace(\"\\r\", \" \").Replace(\"\\n\", \" \").Replace(\"  \", \" \").Trim();                                                                                                                                ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public string ShowSQLCommand(string _commandText, DbParameterCollection _parametersCollection, string[] _ignoreParameters = null)                                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                int count = 0;                                                                                                                                                                                                              ");
            funcoes.AppendLine("                DbParameter[] parms = new DbParameter[_parametersCollection.Count];                                                                                                                                                         ");
            funcoes.AppendLine("                foreach (DbParameter item in _parametersCollection)                                                                                                                                                                         ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                    parms[count] = item;                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    count++;                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                           ");
            funcoes.AppendLine("                return ShowSQLCommand(_commandText, parms, _ignoreParameters);                                                                                                                                                              ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public short ConvertToInt16(object _value, short defaltulValue = 0)                                                                                                                                                                 ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return Convert.ToInt16(_value);                                                                                                                                                                                             ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public int ConvertToInt32(object _value, int defaltulValue = 0)                                                                                                                                                                     ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return Convert.ToInt32(_value);                                                                                                                                                                                             ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public long ConvertToInt64(object _value, long defaltulValue = 0)                                                                                                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return Convert.ToInt64(_value);                                                                                                                                                                                             ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public float ConvertToSingle(object _value, float defaltulValue = 0f)                                                                                                                                                               ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return Convert.ToSingle(_value);                                                                                                                                                                                            ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public double ConvertToDouble(object _value, double defaltulValue = 0d)                                                                                                                                                             ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return Convert.ToDouble(_value);                                                                                                                                                                                            ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public decimal ConvertToDecimal(object _value, decimal defaltulValue = 0m)                                                                                                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return Convert.ToDecimal(_value);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public bool ConvertToBoolean(object _value, bool defaltulValue = false)                                                                                                                                                             ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return Convert.ToBoolean(_value);                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public DateTime ConvertToDateTime(object _value, DateTime? defaltulValue = null)                                                                                                                                                    ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return Convert.ToDateTime(_value);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return defaltulValue == null ? DateTime.MinValue : defaltulValue.Value;                                                                                                                                                     ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public DateTime? GetDateTimeOrNull(object _value)                                                                                                                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return Convert.ToDateTime(_value);                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return null;                                                                                                                                                                                                                ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("        public string ConvertToString(object _value, string defaltulValue = \"\")                                                                                                                                                           ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                             ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return Convert.ToString(_value);                                                                                                                                                                                            ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                               ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                            ");
            funcoes.AppendLine("    }                                                                                                                                                                                                                                       ");
            funcoes.AppendLine("};                                                                                                                                                                                                                                          ");
            return funcoes.ToString();
        }

    }
}
