using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace GeradorCamadaCSharp.Library
{
    public class ArquivoFuncoesADONetForm
    {
        public static string RetornaTextoArquivo(string pacote)
        {
            StringBuilder funcoes = new StringBuilder();
            funcoes.AppendLine("using " + pacote + ".ConstantValues;                                                                                                                                                                                            ");
            funcoes.AppendLine("using System;                                                                                                                                                                                                                        ");
            funcoes.AppendLine("using System.Collections.Generic;                                                                                                                                                                                                    ");
            funcoes.AppendLine("using System.Configuration;                                                                                                                                                                                                          ");
            funcoes.AppendLine("using System.Data;                                                                                                                                                                                                                   ");
            funcoes.AppendLine("using System.Data.Common;                                                                                                                                                                                                            ");
            funcoes.AppendLine("using System.IO;                                                                                                                                                                                                                     ");
            funcoes.AppendLine("using System.Linq;                                                                                                                                                                                                                   ");
            funcoes.AppendLine("using System.Reflection;                                                                                                                                                                                                             ");
            funcoes.AppendLine("using System.Xml.Linq;                                                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("namespace " + pacote + ".Util                                                                                                                                                                                                   ");
            funcoes.AppendLine("{                                                                                                                                                                                                                                    ");
            funcoes.AppendLine("    public class Funcoes                                                                                                                                                                                                             ");
            funcoes.AppendLine("    {                                                                                                                                                                                                                                ");
            funcoes.AppendLine("        static DbProviderFactory factory;                                                                                                                                                                                            ");
            funcoes.AppendLine("        static ProviderEnum dbProvider;                                                                                                                                                                                              ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        private static Funcoes f;                                                                                                                                                                                                    ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        private static string AssemblyDirectory                                                                                                                                                                                      ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            get                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                string codeBase = Assembly.GetExecutingAssembly().CodeBase;                                                                                                                                                          ");
            funcoes.AppendLine("                UriBuilder uri = new UriBuilder(codeBase);                                                                                                                                                                           ");
            funcoes.AppendLine("                string path = Uri.UnescapeDataString(uri.Path);                                                                                                                                                                      ");
            funcoes.AppendLine("                return Path.GetDirectoryName(path);                                                                                                                                                                                  ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        private Funcoes()                                                                                                                                                                                                            ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            dbProvider = (ProviderEnum)Enum.Parse(typeof(ProviderEnum), ConfigurationManager.AppSettings[\"dbProvider\"]);                                                                                                           ");
            funcoes.AppendLine("            factory = DbProviderFactories.GetFactory(EnumDescription.GetDescription(dbProvider));                                                                                                                                    ");
            funcoes.AppendLine("            StringConexao = ConfigurationManager.ConnectionStrings[\"dbConnString\"].ConnectionString;                                                                                                                               ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public static Funcoes newInstance()                                                                                                                                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (f == null)                                                                                                                                                                                                           ");
            funcoes.AppendLine("                f = new Funcoes();                                                                                                                                                                                                   ");
            funcoes.AppendLine("            return f;                                                                                                                                                                                                                ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public string StringConexao { get; set; }                                                                                                                                                                                    ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        private string RecuperarValueString(IEnumerable<XElement> elementos, string key)                                                                                                                                             ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            string value = string.Empty;                                                                                                                                                                                             ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                value = elementos.Where(p => p.Attribute(XName.Get(\"key\")).Value == key).Select(p => p.Attribute(XName.Get(\"value\")).Value).FirstOrDefault();                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            { }                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            return value;                                                                                                                                                                                                            ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        private int RecuperarValueInt(IEnumerable<XElement> elementos, string key)                                                                                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            int value = 0;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                value = ConvertToInt32(elementos.Where(p => p.Attribute(XName.Get(\"key\")).Value == key).Select(p => p.Attribute(XName.Get(\"value\")).Value).FirstOrDefault(), 0);                                                 ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            { }                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            return value;                                                                                                                                                                                                            ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        private bool RecuperarValueBool(IEnumerable<XElement> elementos, string key)                                                                                                                                                 ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            bool value = false;                                                                                                                                                                                                      ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                value = ConvertToBoolean(elementos.Where(p => p.Attribute(XName.Get(\"key\")).Value == key).Select(p => p.Attribute(XName.Get(\"value\")).Value).FirstOrDefault());                                                  ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            { }                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            return value;                                                                                                                                                                                                            ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public string AjustaValor(string _valor)                                                                                                                                                                                     ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            return _valor.Replace(\".\", \"#\").Replace(\",\", \".\").Replace(\"#\", \"\");                                                                                                                                          ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public string RecuperaParametro(string _parametro, int _loja, string _padrao = \"\")                                                                                                                                         ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                string comando = \"select valor from config where loja = ?loja and parametro = ?parametro order by loja, parametro\";                                                                                                ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                DbParameter[] parms = new DbParameter[2];                                                                                                                                                                            ");
            funcoes.AppendLine("                parms[0] = CreateParameter(\"?parametro\", DbType.String, _parametro);                                                                                                                                               ");
            funcoes.AppendLine("                parms[1] = CreateParameter(\"?loja\", DbType.Int16, _loja);                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbDataReader rdr = ExecuteReader(CommandType.Text, comando, parms))                                                                                                                                           ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    if (rdr.Read())                                                                                                                                                                                                  ");
            funcoes.AppendLine("                        return rdr.IsDBNull(0) ? _padrao : rdr.GetString(0);                                                                                                                                                         ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                return _padrao;                                                                                                                                                                                                      ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return _padrao;                                                                                                                                                                                                      ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public char Chr(int codigo)                                                                                                                                                                                                  ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            return (char)codigo;                                                                                                                                                                                                     ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        //Criando Parametros                                                                                                                                                                                                         ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public DbParameter CreateParameter(string _nomeParam, DbType _tipoParam, object _valorParam)                                                                                                                                 ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            return CreateParameter(_nomeParam, ParameterDirection.Input, _tipoParam, _valorParam, null);                                                                                                                             ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DbParameter CreateParameter(string _nomeParam, ParameterDirection _paramDirection, DbType _tipoParam, object _valorParam)                                                                                             ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            return CreateParameter(_nomeParam, _paramDirection, _tipoParam, _valorParam, null);                                                                                                                                      ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DbParameter CreateParameter(string _nomeParam, DbType _tipoParam, object _valorParam, object _valorNulo)                                                                                                              ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            return CreateParameter(_nomeParam, ParameterDirection.Input, _tipoParam, _valorParam, _valorNulo);                                                                                                                       ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DbParameter CreateParameter(string _nomeParam, ParameterDirection _paramDirection, DbType _tipoParam, object _valorParam, object _valorNulo)                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (ProviderEnum.SQLServer.Equals(dbProvider))                                                                                                                                                                           ");
            funcoes.AppendLine("                _nomeParam = _nomeParam.ToString().Replace(\"?\", \"@\");                                                                                                                                                            ");
            funcoes.AppendLine("            else if (ProviderEnum.MySql.Equals(dbProvider))                                                                                                                                                                          ");
            funcoes.AppendLine("                _nomeParam = _nomeParam.ToString().Replace(\"@\", \"?\");                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            DbParameter param = factory.CreateParameter();                                                                                                                                                                           ");
            funcoes.AppendLine("            param.ParameterName = _nomeParam;                                                                                                                                                                                        ");
            funcoes.AppendLine("            param.DbType = _tipoParam;                                                                                                                                                                                               ");
            funcoes.AppendLine("            param.Direction = _paramDirection;                                                                                                                                                                                       ");
            funcoes.AppendLine("            if (_valorParam == null || _valorParam == DBNull.Value)                                                                                                                                                                  ");
            funcoes.AppendLine("                param.Value = DBNull.Value;                                                                                                                                                                                          ");
            funcoes.AppendLine("            else if (_valorNulo != null && _valorNulo.ToString().Equals(_valorParam.ToString()))                                                                                                                                     ");
            funcoes.AppendLine("                param.Value = DBNull.Value;                                                                                                                                                                                          ");
            funcoes.AppendLine("            else                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                switch (_tipoParam)                                                                                                                                                                                                  ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    case DbType.String:                                                                                                                                                                                              ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                            ");
            funcoes.AppendLine("                            if (String.IsNullOrEmpty(_valorParam.ToString()))                                                                                                                                                        ");
            funcoes.AppendLine("                                param.Value = DBNull.Value;                                                                                                                                                                          ");
            funcoes.AppendLine("                            else                                                                                                                                                                                                     ");
            funcoes.AppendLine("                                param.Value = _valorParam.ToString();                                                                                                                                                                ");
            funcoes.AppendLine("                            break;                                                                                                                                                                                                   ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    case DbType.DateTime:                                                                                                                                                                                            ");
            funcoes.AppendLine("                    case DbType.Date:                                                                                                                                                                                                ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                            ");
            funcoes.AppendLine("                            DateTime dateTime = Convert.ToDateTime(_valorParam);                                                                                                                                                     ");
            funcoes.AppendLine("                            if (dateTime.Equals(DateTime.MinValue))                                                                                                                                                                  ");
            funcoes.AppendLine("                                param.Value = DBNull.Value;                                                                                                                                                                          ");
            funcoes.AppendLine("                            else                                                                                                                                                                                                     ");
            funcoes.AppendLine("                                param.Value = dateTime;                                                                                                                                                                              ");
            funcoes.AppendLine("                            break;                                                                                                                                                                                                   ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    default:                                                                                                                                                                                                         ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                            ");
            funcoes.AppendLine("                            param.Value = _valorParam;                                                                                                                                                                               ");
            funcoes.AppendLine("                            break;                                                                                                                                                                                                   ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                            ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            return param;                                                                                                                                                                                                            ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public void AjustaStringSQL(ref string _cmdSQL)                                                                                                                                                                              ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (ProviderEnum.SQLServer.Equals(dbProvider))                                                                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                _cmdSQL = _cmdSQL.ToString().Replace(\"?\", \"@\").Trim();                                                                                                                                                           ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                if (_cmdSQL.ToUpper().StartsWith(\"INSERT\"))                                                                                                                                                                        ");
            funcoes.AppendLine("                    _cmdSQL += (_cmdSQL.Trim().EndsWith(\";\") ? \"\" : \";\") + \" select @@identity;\";                                                                                                                            ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            else if (ProviderEnum.MySql.Equals(dbProvider))                                                                                                                                                                          ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                _cmdSQL = _cmdSQL.ToString().Replace(\"@\", \"?\").Trim();                                                                                                                                                           ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                if (_cmdSQL.ToUpper().StartsWith(\"INSERT\"))                                                                                                                                                                        ");
            funcoes.AppendLine("                    _cmdSQL += (_cmdSQL.Trim().EndsWith(\";\") ? \"\" : \";\") + \" select last_insert_id();\";                                                                                                                      ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        //Trabalhando com String de Conexão Constante                                                                                                                                                                                ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                                              ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbConnection cnx = factory.CreateConnection())                                                                                                                                                                ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cnx.ConnectionString = StringConexao;                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                  ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                       ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                        ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                   ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                     ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                    ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                       ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                              ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        if (_cmdSQL.ToUpper().StartsWith(\"INSERT\"))                                                                                                                                                                ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                            ");
            funcoes.AppendLine("                            _lastInsertId = ConvertToInt64(cmd.ExecuteScalar());                                                                                                                                                     ");
            funcoes.AppendLine("                            return _lastInsertId > 0;                                                                                                                                                                                ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        else                                                                                                                                                                                                         ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                            ");
            funcoes.AppendLine("                            _lastInsertId = 0;                                                                                                                                                                                       ");
            funcoes.AppendLine("                            return cmd.ExecuteNonQuery() > 0;                                                                                                                                                                        ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                                      ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            return ExecuteNonQuery(_cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                                         ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                                           ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbConnection cnx = factory.CreateConnection())                                                                                                                                                                ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cnx.ConnectionString = StringConexao;                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                  ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                       ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                        ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                   ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                     ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                    ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                       ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                              ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        int i = cmd.ExecuteNonQuery();                                                                                                                                                                               ");
            funcoes.AppendLine("                        _lastInsertId = 0; //cmd.LastInsertedId;                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        return i;                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            return ExecuteNonQueryRows(_cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                                     ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public object ExecuteScalar(CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                                      ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbConnection cnx = factory.CreateConnection())                                                                                                                                                                ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cnx.ConnectionString = StringConexao;                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                  ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                       ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                        ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                   ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                     ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                    ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                       ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                              ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        object i = cmd.ExecuteScalar();                                                                                                                                                                              ");
            funcoes.AppendLine("                        return i;                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DbDataReader ExecuteReader(CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                                ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                DbConnection cnx = factory.CreateConnection();                                                                                                                                                                       ");
            funcoes.AppendLine("                cnx.ConnectionString = StringConexao;                                                                                                                                                                                ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                      ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.Connection = cnx;                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                      ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                       ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                          ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                           ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    if (cnx.State != ConnectionState.Open)                                                                                                                                                                           ");
            funcoes.AppendLine("                        cnx.Open();                                                                                                                                                                                                  ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    DbDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);                                                                                                                                           ");
            funcoes.AppendLine("                    return rdr;                                                                                                                                                                                                      ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DataTable FillDataTable(CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                DataTable dt = new DataTable();                                                                                                                                                                                      ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbConnection cnx = factory.CreateConnection())                                                                                                                                                                ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cnx.ConnectionString = StringConexao;                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                  ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                        ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                   ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                     ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                    ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                       ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                      ");
            funcoes.AppendLine("                        using (DbDataAdapter da = factory.CreateDataAdapter())                                                                                                                                                       ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                            ");
            funcoes.AppendLine("                            da.SelectCommand = cmd;                                                                                                                                                                                  ");
            funcoes.AppendLine("                            da.Fill(dt);                                                                                                                                                                                             ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                return dt;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        //Trabalhando com String de Conexao Variável                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(string _stringConexao, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                       ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbConnection cnx = factory.CreateConnection())                                                                                                                                                                ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cnx.ConnectionString = StringConexao;                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                  ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                       ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                        ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                   ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                     ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                    ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                       ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                              ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        if (_cmdSQL.ToUpper().StartsWith(\"INSERT\"))                                                                                                                                                                ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                            ");
            funcoes.AppendLine("                            _lastInsertId = ConvertToInt64(cmd.ExecuteScalar());                                                                                                                                                     ");
            funcoes.AppendLine("                            return _lastInsertId > 0;                                                                                                                                                                                ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                            ");
            funcoes.AppendLine("                        else                                                                                                                                                                                                         ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                            ");
            funcoes.AppendLine("                            _lastInsertId = 0;                                                                                                                                                                                       ");
            funcoes.AppendLine("                            return cmd.ExecuteNonQuery() > 0;                                                                                                                                                                        ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(string _stringConexao, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                               ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            return ExecuteNonQuery(_stringConexao, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                         ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(string _stringConexao, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                    ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbConnection cnx = factory.CreateConnection())                                                                                                                                                                ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cnx.ConnectionString = StringConexao;                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                  ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                       ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                        ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                   ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                     ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                    ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                       ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                              ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        int i = cmd.ExecuteNonQuery();                                                                                                                                                                               ");
            funcoes.AppendLine("                        _lastInsertId = 0; //cmd.LastInsertedId;                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        return i;                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(string _stringConexao, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                            ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            return ExecuteNonQueryRows(_stringConexao, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                     ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public object ExecuteScalar(string _stringConexao, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                               ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbConnection cnx = factory.CreateConnection())                                                                                                                                                                ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cnx.ConnectionString = StringConexao;                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                  ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                       ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                        ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                   ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                     ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                    ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        if (cnx.State != ConnectionState.Open)                                                                                                                                                                       ");
            funcoes.AppendLine("                            cnx.Open();                                                                                                                                                                                              ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        object i = cmd.ExecuteScalar();                                                                                                                                                                              ");
            funcoes.AppendLine("                        return i;                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DbDataReader ExecuteReader(string _stringConexao, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                         ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                DbConnection cnx = factory.CreateConnection();                                                                                                                                                                       ");
            funcoes.AppendLine("                cnx.ConnectionString = StringConexao;                                                                                                                                                                                ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                      ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.Connection = cnx;                                                                                                                                                                                            ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                      ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                       ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                          ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                           ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    if (cnx.State != ConnectionState.Open)                                                                                                                                                                           ");
            funcoes.AppendLine("                        cnx.Open();                                                                                                                                                                                                  ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    DbDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);                                                                                                                                           ");
            funcoes.AppendLine("                    return rdr;                                                                                                                                                                                                      ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DataTable FillDataTable(string _stringConexao, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                            ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                DataTable dt = new DataTable();                                                                                                                                                                                      ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbConnection cnx = factory.CreateConnection())                                                                                                                                                                ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cnx.ConnectionString = StringConexao;                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                  ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        cmd.Connection = cnx;                                                                                                                                                                                        ");
            funcoes.AppendLine("                        cmd.CommandType = _cmdType;                                                                                                                                                                                  ");
            funcoes.AppendLine("                        cmd.CommandText = _cmdSQL;                                                                                                                                                                                   ");
            funcoes.AppendLine("                        if (_commandTimeout > 0)                                                                                                                                                                                     ");
            funcoes.AppendLine("                            cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                    ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                        cmd.Parameters.Clear();                                                                                                                                                                                      ");
            funcoes.AppendLine("                        if (_parmsSQL != null)                                                                                                                                                                                       ");
            funcoes.AppendLine("                            cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                      ");
            funcoes.AppendLine("                        using (DbDataAdapter da = factory.CreateDataAdapter())                                                                                                                                                       ");
            funcoes.AppendLine("                        {                                                                                                                                                                                                            ");
            funcoes.AppendLine("                            da.SelectCommand = cmd;                                                                                                                                                                                  ");
            funcoes.AppendLine("                            da.Fill(dt);                                                                                                                                                                                             ");
            funcoes.AppendLine("                        }                                                                                                                                                                                                            ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                return dt;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        //Trabalhando com Objeto de Conexão                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public DbConnection OpenConnection(string _connectionString)                                                                                                                                                                 ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (String.IsNullOrEmpty(_connectionString))                                                                                                                                                                             ");
            funcoes.AppendLine("                throw new ArgumentNullException();                                                                                                                                                                                   ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                DbConnection cnx = factory.CreateConnection();                                                                                                                                                                       ");
            funcoes.AppendLine("                cnx.ConnectionString = _connectionString;                                                                                                                                                                            ");
            funcoes.AppendLine("                if (cnx.State != ConnectionState.Open)                                                                                                                                                                               ");
            funcoes.AppendLine("                    cnx.Open();                                                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                return cnx;                                                                                                                                                                                                          ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException dbError)                                                                                                                                                                                              ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(dbError.Message, dbError);                                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception error)                                                                                                                                                                                                  ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(error.Message, error);                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DbConnection OpenConnection()                                                                                                                                                                                         ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            return OpenConnection(StringConexao);                                                                                                                                                                                    ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public void CloseConnection(DbConnection _connection)                                                                                                                                                                        ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                if (_connection == null)                                                                                                                                                                                             ");
            funcoes.AppendLine("                    return;                                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                _connection.Close();                                                                                                                                                                                                 ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException dbError)                                                                                                                                                                                              ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(dbError.Message, dbError);                                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception error)                                                                                                                                                                                                  ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(error.Message, error);                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(DbConnection _connection, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                    ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                      ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                          ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                           ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    cmd.Connection = _connection;                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                      ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                       ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    if (_connection.State != ConnectionState.Open)                                                                                                                                                                   ");
            funcoes.AppendLine("                        _connection.Open();                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    if (_cmdSQL.ToUpper().StartsWith(\"INSERT\"))                                                                                                                                                                    ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        _lastInsertId = ConvertToInt64(cmd.ExecuteScalar());                                                                                                                                                         ");
            funcoes.AppendLine("                        return _lastInsertId > 0;                                                                                                                                                                                    ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                    else                                                                                                                                                                                                             ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        _lastInsertId = 0;                                                                                                                                                                                           ");
            funcoes.AppendLine("                        return cmd.ExecuteNonQuery() > 0;                                                                                                                                                                            ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(DbConnection _connection, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                            ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            return ExecuteNonQuery(_connection, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                            ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(DbConnection _connection, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                 ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                      ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                          ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                           ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    cmd.Connection = _connection;                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                      ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                       ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    if (_connection.State != ConnectionState.Open)                                                                                                                                                                   ");
            funcoes.AppendLine("                        _connection.Open();                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    int i = cmd.ExecuteNonQuery();                                                                                                                                                                                   ");
            funcoes.AppendLine("                    _lastInsertId = 0; //cmd.LastInsertedId;                                                                                                                                                                         ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    return i;                                                                                                                                                                                                        ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(DbConnection _connection, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                         ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            return ExecuteNonQueryRows(_connection, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public object ExecuteScalar(DbConnection _connection, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                            ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                      ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                          ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                           ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    cmd.Connection = _connection;                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                      ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                       ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    if (_connection.State != ConnectionState.Open)                                                                                                                                                                   ");
            funcoes.AppendLine("                        _connection.Open();                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    object i = cmd.ExecuteScalar();                                                                                                                                                                                  ");
            funcoes.AppendLine("                    return i;                                                                                                                                                                                                        ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DbDataReader ExecuteReader(DbConnection _connection, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                      ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                      ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.Connection = _connection;                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                      ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                       ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                          ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                           ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    if (_connection.State != ConnectionState.Open)                                                                                                                                                                   ");
            funcoes.AppendLine("                        _connection.Open();                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    DbDataReader rdr = cmd.ExecuteReader(CommandBehavior.CloseConnection);                                                                                                                                           ");
            funcoes.AppendLine("                    return rdr;                                                                                                                                                                                                      ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DataTable FillDataTable(DbConnection _connection, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                         ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                DataTable dt = new DataTable();                                                                                                                                                                                      ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                      ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.Connection = _connection;                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                      ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                       ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                          ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                           ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    using (DbDataAdapter da = factory.CreateDataAdapter())                                                                                                                                                           ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        da.SelectCommand = cmd;                                                                                                                                                                                      ");
            funcoes.AppendLine("                        da.Fill(dt);                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                return dt;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        //Trabalhando com Transação                                                                                                                                                                                                  ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        DbTransaction BeginTransaction(string _connectionString, IsolationLevel _isolationLevel)                                                                                                                                     ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            DbTransaction trans = null;                                                                                                                                                                                              ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                DbConnection conn = factory.CreateConnection();                                                                                                                                                                      ");
            funcoes.AppendLine("                conn.ConnectionString = StringConexao;                                                                                                                                                                               ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                if (conn.State != ConnectionState.Open)                                                                                                                                                                              ");
            funcoes.AppendLine("                    conn.Open();                                                                                                                                                                                                     ");
            funcoes.AppendLine("                trans = conn.BeginTransaction(_isolationLevel);                                                                                                                                                                      ");
            funcoes.AppendLine("                return trans;                                                                                                                                                                                                        ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException dbError)                                                                                                                                                                                              ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(dbError.Message, dbError);                                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception error)                                                                                                                                                                                                  ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(error.Message, error);                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DbTransaction BeginTransaction(string _connectionString)                                                                                                                                                              ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (String.IsNullOrEmpty(_connectionString))                                                                                                                                                                             ");
            funcoes.AppendLine("                throw new ArgumentNullException();                                                                                                                                                                                   ");
            funcoes.AppendLine("            return BeginTransaction(_connectionString, IsolationLevel.ReadCommitted);                                                                                                                                                ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DbTransaction BeginTransaction()                                                                                                                                                                                      ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (String.IsNullOrEmpty(StringConexao))                                                                                                                                                                                 ");
            funcoes.AppendLine("                throw new ArgumentNullException();                                                                                                                                                                                   ");
            funcoes.AppendLine("            return BeginTransaction(StringConexao, IsolationLevel.ReadCommitted);                                                                                                                                                    ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public void CommitTransaction(DbTransaction _transaction)                                                                                                                                                                    ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                try                                                                                                                                                                                                                  ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    DbConnection conn = _transaction.Connection;                                                                                                                                                                     ");
            funcoes.AppendLine("                    _transaction.Commit();                                                                                                                                                                                           ");
            funcoes.AppendLine("                    if (conn != null)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        conn.Dispose();                                                                                                                                                                                              ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                catch (DbException dbError)                                                                                                                                                                                          ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    throw new Exception(dbError.Message, dbError);                                                                                                                                                                   ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                catch (Exception error)                                                                                                                                                                                              ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    throw new Exception(error.Message, error);                                                                                                                                                                       ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            else                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                throw new ArgumentException(\"Object transaction cannot be null\");                                                                                                                                                  ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public void RollbackTransaction(DbTransaction _transaction)                                                                                                                                                                  ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                try                                                                                                                                                                                                                  ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    DbConnection conn = _transaction.Connection;                                                                                                                                                                     ");
            funcoes.AppendLine("                    _transaction.Rollback();                                                                                                                                                                                         ");
            funcoes.AppendLine("                    if (conn != null)                                                                                                                                                                                                ");
            funcoes.AppendLine("                        conn.Dispose();                                                                                                                                                                                              ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                catch (DbException dbError)                                                                                                                                                                                          ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    throw new Exception(dbError.Message, dbError);                                                                                                                                                                   ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                catch (Exception error)                                                                                                                                                                                              ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    throw new Exception(error.Message, error);                                                                                                                                                                       ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            else                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                throw new ArgumentException(\"Object transaction cannot be null\");                                                                                                                                                  ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(DbTransaction _transaction, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                                  ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            DbConnection cnx = _transaction.Connection;                                                                                                                                                                              ");
            funcoes.AppendLine("            DbCommand cmd = factory.CreateCommand();                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.Parameters.Clear();                                                                                                                                                                                                  ");
            funcoes.AppendLine("            if (_parmsSQL != null)                                                                                                                                                                                                   ");
            funcoes.AppendLine("                cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                  ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.Connection = cnx;                                                                                                                                                                                                    ");
            funcoes.AppendLine("            cmd.CommandType = _cmdType;                                                                                                                                                                                              ");
            funcoes.AppendLine("            cmd.CommandText = _cmdSQL;                                                                                                                                                                                               ");
            funcoes.AppendLine("            if (_commandTimeout > 0)                                                                                                                                                                                                 ");
            funcoes.AppendLine("                cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                                ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            if (cnx.State != ConnectionState.Open)                                                                                                                                                                                   ");
            funcoes.AppendLine("                cnx.Open();                                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                ");
            funcoes.AppendLine("                cmd.Transaction = _transaction;                                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            if (_cmdSQL.ToUpper().StartsWith(\"INSERT\"))                                                                                                                                                                            ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                _lastInsertId = ConvertToInt64(cmd.ExecuteScalar());                                                                                                                                                                 ");
            funcoes.AppendLine("                return _lastInsertId > 0;                                                                                                                                                                                            ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            else                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                _lastInsertId = 0;                                                                                                                                                                                                   ");
            funcoes.AppendLine("                return cmd.ExecuteNonQuery() > 0;                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public bool ExecuteNonQuery(DbTransaction _transaction, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            return ExecuteNonQuery(_transaction, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                           ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(DbTransaction _transaction, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, out long _lastInsertId, int _commandTimeout = 60000)                                               ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            DbConnection cnx = _transaction.Connection;                                                                                                                                                                              ");
            funcoes.AppendLine("            DbCommand cmd = factory.CreateCommand();                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.Parameters.Clear();                                                                                                                                                                                                  ");
            funcoes.AppendLine("            if (_parmsSQL != null)                                                                                                                                                                                                   ");
            funcoes.AppendLine("                cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                  ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.Connection = cnx;                                                                                                                                                                                                    ");
            funcoes.AppendLine("            cmd.CommandType = _cmdType;                                                                                                                                                                                              ");
            funcoes.AppendLine("            cmd.CommandText = _cmdSQL;                                                                                                                                                                                               ");
            funcoes.AppendLine("            if (_commandTimeout > 0)                                                                                                                                                                                                 ");
            funcoes.AppendLine("                cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                                ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            if (cnx.State != ConnectionState.Open)                                                                                                                                                                                   ");
            funcoes.AppendLine("                cnx.Open();                                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                ");
            funcoes.AppendLine("                cmd.Transaction = _transaction;                                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            int i = cmd.ExecuteNonQuery();                                                                                                                                                                                           ");
            funcoes.AppendLine("            _lastInsertId = 0; //cmd.LastInsertedId;                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            return i;                                                                                                                                                                                                                ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public int ExecuteNonQueryRows(DbTransaction _transaction, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                       ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            long zero = 0;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            return ExecuteNonQueryRows(_transaction, _cmdType, _cmdSQL, _parmsSQL, out zero, _commandTimeout);                                                                                                                       ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public object ExecuteScalar(DbTransaction _transaction, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            DbConnection cnx = _transaction.Connection;                                                                                                                                                                              ");
            funcoes.AppendLine("            DbCommand cmd = factory.CreateCommand();                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.Parameters.Clear();                                                                                                                                                                                                  ");
            funcoes.AppendLine("            if (_parmsSQL != null)                                                                                                                                                                                                   ");
            funcoes.AppendLine("                cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                  ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.Connection = cnx;                                                                                                                                                                                                    ");
            funcoes.AppendLine("            cmd.CommandType = _cmdType;                                                                                                                                                                                              ");
            funcoes.AppendLine("            cmd.CommandText = _cmdSQL;                                                                                                                                                                                               ");
            funcoes.AppendLine("            if (_commandTimeout > 0)                                                                                                                                                                                                 ");
            funcoes.AppendLine("                cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                                ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            if (cnx.State != ConnectionState.Open)                                                                                                                                                                                   ");
            funcoes.AppendLine("                cnx.Open();                                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                ");
            funcoes.AppendLine("                cmd.Transaction = _transaction;                                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            object i = cmd.ExecuteScalar();                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            return i;                                                                                                                                                                                                                ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DbDataReader ExecuteReader(DbTransaction _transaction, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                    ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            DbConnection cnx = _transaction.Connection;                                                                                                                                                                              ");
            funcoes.AppendLine("            DbCommand cmd = factory.CreateCommand();                                                                                                                                                                                 ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.Connection = cnx;                                                                                                                                                                                                    ");
            funcoes.AppendLine("            cmd.CommandType = _cmdType;                                                                                                                                                                                              ");
            funcoes.AppendLine("            cmd.CommandText = _cmdSQL;                                                                                                                                                                                               ");
            funcoes.AppendLine("            if (_commandTimeout > 0)                                                                                                                                                                                                 ");
            funcoes.AppendLine("                cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                                ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            cmd.Parameters.Clear();                                                                                                                                                                                                  ");
            funcoes.AppendLine("            if (_parmsSQL != null)                                                                                                                                                                                                   ");
            funcoes.AppendLine("                cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                                  ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            if (cnx.State != ConnectionState.Open)                                                                                                                                                                                   ");
            funcoes.AppendLine("                cnx.Open();                                                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            if (_transaction != null)                                                                                                                                                                                                ");
            funcoes.AppendLine("                cmd.Transaction = _transaction;                                                                                                                                                                                      ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("            DbDataReader rdr = cmd.ExecuteReader();                                                                                                                                                                                  ");
            funcoes.AppendLine("            return rdr;                                                                                                                                                                                                              ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DataTable FillDataTable(DbTransaction _transaction, CommandType _cmdType, string _cmdSQL, DbParameter[] _parmsSQL, int _commandTimeout = 60000)                                                                       ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                AjustaStringSQL(ref _cmdSQL);                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                DataTable dt = new DataTable();                                                                                                                                                                                      ");
            funcoes.AppendLine("                using (DbCommand cmd = factory.CreateCommand())                                                                                                                                                                      ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    cmd.Connection = _transaction.Connection;                                                                                                                                                                        ");
            funcoes.AppendLine("                    cmd.CommandType = _cmdType;                                                                                                                                                                                      ");
            funcoes.AppendLine("                    cmd.CommandText = _cmdSQL;                                                                                                                                                                                       ");
            funcoes.AppendLine("                    if (_commandTimeout > 0)                                                                                                                                                                                         ");
            funcoes.AppendLine("                        cmd.CommandTimeout = _commandTimeout;                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    cmd.Parameters.Clear();                                                                                                                                                                                          ");
            funcoes.AppendLine("                    if (_parmsSQL != null)                                                                                                                                                                                           ");
            funcoes.AppendLine("                        cmd.Parameters.AddRange(_parmsSQL);                                                                                                                                                                          ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    if (_transaction != null)                                                                                                                                                                                        ");
            funcoes.AppendLine("                        cmd.Transaction = _transaction;                                                                                                                                                                              ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                    using (DbDataAdapter da = factory.CreateDataAdapter())                                                                                                                                                           ");
            funcoes.AppendLine("                    {                                                                                                                                                                                                                ");
            funcoes.AppendLine("                        da.SelectCommand = cmd;                                                                                                                                                                                      ");
            funcoes.AppendLine("                        da.Fill(dt);                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    }                                                                                                                                                                                                                ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                return dt;                                                                                                                                                                                                           ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (DbException mErr)                                                                                                                                                                                                 ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(mErr.Message);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        ///////////////////////////////                                                                                                                                                                                              ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public string ShowSQLCommand(string _commandText, IDataParameter[] _cmdParameters, string[] _ignoreParameters = null)                                                                                                        ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            string parameterValue = string.Empty;                                                                                                                                                                                    ");
            funcoes.AppendLine("            for (int indexParameters = _cmdParameters.Length - 1; indexParameters >= 0; indexParameters--)                                                                                                                           ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                parameterValue = string.Empty;                                                                                                                                                                                       ");
            funcoes.AppendLine("                string identifier = _cmdParameters[indexParameters].ParameterName.Contains(\"?\") ? string.Empty : \"?\";                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                if (_ignoreParameters != null && _ignoreParameters.ToList().Exists(p => (\"?\" + p.ToLower()).Equals(_cmdParameters[indexParameters].ParameterName.ToLower())))                                                      ");
            funcoes.AppendLine("                    continue;                                                                                                                                                                                                        ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                if (_cmdParameters[indexParameters].DbType == DbType.DateTime)                                                                                                                                                       ");
            funcoes.AppendLine("                    parameterValue = string.IsNullOrEmpty(_cmdParameters[indexParameters].Value.ToString()) ? \"NULL\" : \"'\" + Convert.ToDateTime(_cmdParameters[indexParameters].Value).ToString(\"yyyy-MM-dd HH:mm:ss\") + \"'\";");
            funcoes.AppendLine("                else if (_cmdParameters[indexParameters].DbType == DbType.Date)                                                                                                                                                      ");
            funcoes.AppendLine("                    parameterValue = string.IsNullOrEmpty(_cmdParameters[indexParameters].Value.ToString()) ? \"NULL\" : \"'\" + Convert.ToDateTime(_cmdParameters[indexParameters].Value).ToString(\"yyyy-MM-dd\") + \"'\";         ");
            funcoes.AppendLine("                else if (_cmdParameters[indexParameters].DbType == DbType.Decimal || _cmdParameters[indexParameters].DbType == DbType.Double || _cmdParameters[indexParameters].DbType == DbType.Single)                             ");
            funcoes.AppendLine("                    parameterValue = AjustaValor(_cmdParameters[indexParameters].Value.ToString());                                                                                                                                  ");
            funcoes.AppendLine("                else if (_cmdParameters[indexParameters].DbType == DbType.Int16 || _cmdParameters[indexParameters].DbType == DbType.Int32 || _cmdParameters[indexParameters].DbType == DbType.Int64)                                 ");
            funcoes.AppendLine("                    parameterValue = ConvertToInt64(_cmdParameters[indexParameters].Value).ToString();                                                                                                                               ");
            funcoes.AppendLine("                else                                                                                                                                                                                                                 ");
            funcoes.AppendLine("                    parameterValue = string.IsNullOrEmpty(_cmdParameters[indexParameters].Value.ToString()) ? \"NULL\" : \"'\" + _cmdParameters[indexParameters].Value.ToString() + \"'\";                                           ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("                _commandText = _commandText.Replace(identifier + _cmdParameters[indexParameters].ParameterName, parameterValue);                                                                                                     ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            return _commandText.Replace(\"\\r\", \" \").Replace(\"\\n\", \" \").Replace(\"  \", \" \").Trim();                                                                                                                                ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public string ShowSQLCommand(string _commandText, DbParameterCollection _parametersCollection, string[] _ignoreParameters = null)                                                                                            ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                int count = 0;                                                                                                                                                                                                       ");
            funcoes.AppendLine("                DbParameter[] parms = new DbParameter[_parametersCollection.Count];                                                                                                                                                  ");
            funcoes.AppendLine("                foreach (DbParameter item in _parametersCollection)                                                                                                                                                                  ");
            funcoes.AppendLine("                {                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                    parms[count] = item;                                                                                                                                                                                             ");
            funcoes.AppendLine("                    count++;                                                                                                                                                                                                         ");
            funcoes.AppendLine("                }                                                                                                                                                                                                                    ");
            funcoes.AppendLine("                return ShowSQLCommand(_commandText, parms, _ignoreParameters);                                                                                                                                                       ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch (Exception err)                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                throw new Exception(err.Message);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("        public short ConvertToInt16(object _value, short defaltulValue = 0)                                                                                                                                                          ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return Convert.ToInt16(_value);                                                                                                                                                                                      ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public int ConvertToInt32(object _value, int defaltulValue = 0)                                                                                                                                                              ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return Convert.ToInt32(_value);                                                                                                                                                                                      ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public long ConvertToInt64(object _value, long defaltulValue = 0)                                                                                                                                                            ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return Convert.ToInt64(_value);                                                                                                                                                                                      ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public float ConvertToSingle(object _value, float defaltulValue = 0f)                                                                                                                                                        ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return Convert.ToSingle(_value);                                                                                                                                                                                     ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public double ConvertToDouble(object _value, double defaltulValue = 0d)                                                                                                                                                      ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return Convert.ToDouble(_value);                                                                                                                                                                                     ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public decimal ConvertToDecimal(object _value, decimal defaltulValue = 0m)                                                                                                                                                   ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return Convert.ToDecimal(_value);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public bool ConvertToBoolean(object _value, bool defaltulValue = false)                                                                                                                                                      ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return Convert.ToBoolean(_value);                                                                                                                                                                                    ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DateTime ConvertToDateTime(object _value, DateTime? defaltulValue = null)                                                                                                                                             ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return Convert.ToDateTime(_value);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return defaltulValue == null ? DateTime.MinValue : defaltulValue.Value;                                                                                                                                              ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public DateTime? GetDateTimeOrNull(object _value)                                                                                                                                                                            ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return Convert.ToDateTime(_value);                                                                                                                                                                                   ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return null;                                                                                                                                                                                                         ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("        public string ConvertToString(object _value, string defaltulValue = \"\")                                                                                                                                                    ");
            funcoes.AppendLine("        {                                                                                                                                                                                                                            ");
            funcoes.AppendLine("            try                                                                                                                                                                                                                      ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return Convert.ToString(_value);                                                                                                                                                                                     ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("            catch                                                                                                                                                                                                                    ");
            funcoes.AppendLine("            {                                                                                                                                                                                                                        ");
            funcoes.AppendLine("                return defaltulValue;                                                                                                                                                                                                ");
            funcoes.AppendLine("            }                                                                                                                                                                                                                        ");
            funcoes.AppendLine("        }                                                                                                                                                                                                                            ");
            funcoes.AppendLine("                                                                                                                                                                                                                                     ");
            funcoes.AppendLine("    }                                                                                                                                                                                                                                ");
            funcoes.AppendLine("};                                                                                                                                                                                                                                   ");
            return funcoes.ToString();
        }

    }
}
